<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>AuDi: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AuDi
   &#160;<span id="projectnumber">V.0.1</span>
   </div>
   <div id="projectbrief">An automated differentiation library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AuDi Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="z"></a>
Listen (Introduction)</h1>
<p>Audi (not the car, rather from latin: "listen!") is an open source, header only, C++ library that allows for AUtomated DIfferentiation implementing the Taylor truncated polynomial algebra (forward mode automated differentiation). It was created with the aim to offer a generic solution to the user in need of an automated differentiation system. While other automated differentiation codes may be more efficient on some targeted application, AuDi was built to be fast and efficient across all application ranges (low orders, high orders, one variable, many variables). Its use should be rather straight forward and is illustarted in the getting started example below.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;audi/audi.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceaudi.html">audi</a>;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="comment">// We want to compute the Taylor expansion of a function f (and thus all derivatives) at x=2, y=3</span></div>
<div class="line">    <span class="comment">// 1 - Define the generalized dual numbers (7 is the truncation order, i.e. the maximum order of derivation we will need)</span></div>
<div class="line">    <a class="code" href="classaudi_1_1gdual.html">gdual</a> x(2, <span class="stringliteral">&quot;x&quot;</span>, 7);</div>
<div class="line">    <a class="code" href="classaudi_1_1gdual.html">gdual</a> y(3, <span class="stringliteral">&quot;y&quot;</span>, 7);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// 2 - Compute your function as usual</span></div>
<div class="line">    <a class="code" href="classaudi_1_1gdual.html">gdual</a> f = <a class="code" href="namespaceaudi.html#abc6fc320e20791ef2dfb7821da0eec69">exp</a>((x*x+<a class="code" href="namespaceaudi.html#adda903acffda0d9351499fcef9a7b22a">cbrt</a>(y)/<a class="code" href="namespaceaudi.html#a8af379f801041edcedcaadf2f999f358">log</a>(x*y)));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// 3 - Inspect the results</span></div>
<div class="line">    std::cout &lt;&lt; f &lt;&lt; std::endl;                        <span class="comment">// This is the entire Taylor expansion of f (truncated at the 7th order)</span></div>
<div class="line">    std::cout &lt;&lt; f.<a class="code" href="classaudi_1_1gdual.html#a4240d101b39e51e67fea6ca0308d5f74">get_derivative</a>({4,3}) &lt;&lt; std::endl;  <span class="comment">// This is the value of the mixed derivative (d^7 / dx^4dy^3)</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>AuDi is internally powered by the truncated polynomial multiplication algorithm of the open source project, <a href="https://github.com/bluescarni/piranha">Piranha</a> details of which are described in:</p>
<p>Biscani, Francesco. <a href="http://dl.acm.org/citation.cfm?id=2442845">"Parallel sparse polynomial multiplication on modern hardware architectures."</a> Proceedings of the 37th International Symposium on Symbolic and Algebraic Computation. ACM, 2012.</p>
<p>Biscani, Francesco. <a href="http://arxiv.org/pdf/1004.4548v1.pdf">"Multiplication of sparse Laurent polynomials and Poisson
series on modern hardware architectures."</a> arXiv preprint arXiv:1004.4548 (2010).</p>
<pre class="fragment">Piranha headers must be installed and accessible to the compiler for AuDi to function.
</pre><p>In the following sections we present, briefly, the theory and some concrete examples to help understanding the forward automated differentiation using truncated Taylor polynomials implemented in AuDi.</p>
<h1><a class="anchor" id="a"></a>
The algebra of truncated polynomials</h1>
<p>Here we introduce formally a basic algebraic structure over the set of truncated polynomials and we show how such a structure allows to compute the partial derivatives of multivariate functions up to arbitrary order.</p>
<h2><a class="anchor" id="b"></a>
Formal definition</h2>
<p>Consider the set <img class="formulaInl" alt="$ \mathcal P_{n,m}$" src="form_0.png"/> of all polynomials of order <img class="formulaInl" alt="$\le m$" src="form_1.png"/> in <img class="formulaInl" alt="$n$" src="form_2.png"/> variables and having coefficients in <img class="formulaInl" alt="$\mathbf K$" src="form_3.png"/>. We indicate with the symbols <img class="formulaInl" alt="$T_f, T_g, T_h$" src="form_4.png"/>, etc. the generic members of such a set. Such a set is an algebra over the field <img class="formulaInl" alt="$\mathbf K$" src="form_3.png"/> if we introduce the truncated multiplication as the standard polynomial multiplication truncated at order <img class="formulaInl" alt="$m$" src="form_5.png"/>. When needed, we will indicate such a multiplication with the symbol <img class="formulaInl" alt="$T_f \cdot T_g$" src="form_6.png"/>.</p>
<p>This algebra is commonly referred to as the algebra of truncated polynomials. A first important property of this algebra is that, under the multiplication, all polynomials having a zero constant coefficient are nil-potent of order <img class="formulaInl" alt="$m+1$" src="form_7.png"/>, as easily verified. We will indicate the generic truncated polynomial <img class="formulaInl" alt="$\in \mathcal P_{n,m}$" src="form_8.png"/> as <img class="formulaInl" alt="$T_f$" src="form_9.png"/> and often we will consider its constant part separated from the rest, writing <img class="formulaInl" alt="$T_f = f_0 + \hat f$" src="form_10.png"/>. It is worth noting at this point how such an algebra is unitary and associative. The first property, in particular, deserves a few more words as it is a property that the algebra of (non-truncated) polynomials does not possess. Formally <img class="formulaInl" alt="$\forall T_f \in \mathcal P_{n,m}, \: \exists !\: T_g\in \mathcal P_{n,m} \Rightarrow T_g\cdot T_f = 1$" src="form_11.png"/>. In practice: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_g = \frac 1{T_f} = \frac 1{f_0} \left(1 +\sum_{k=1}^m (-1)^k (\hat f / f_0)^k\right) \]" src="form_116.png"/>
</p>
<p> as its easily verified by performing the truncated multiplication <img class="formulaInl" alt="$T_g \cdot T_f$" src="form_13.png"/> and accounting for the nilpotency of <img class="formulaInl" alt="$\hat f$" src="form_14.png"/>.</p>
<h2><a class="anchor" id="c"></a>
The link to Taylor expansions</h2>
<p>We make use of the multi-index notation according to which <img class="formulaInl" alt="$\alpha = (\alpha_1, ..,\alpha_n)$" src="form_15.png"/> and <img class="formulaInl" alt="$\mathbf x = (x_1, .., x_n)$" src="form_16.png"/> are n-tuples and the Taylor expansion around the point <img class="formulaInl" alt="$\mathbf a$" src="form_17.png"/> to order <img class="formulaInl" alt="$m$" src="form_5.png"/> of a multivariate function <img class="formulaInl" alt="$f$" src="form_18.png"/> of <img class="formulaInl" alt="$\mathbf x$" src="form_19.png"/> is written as: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_f(\mathbf x) = \sum_{|\alpha| = 0}^m \frac{(\mathbf x-\mathbf a)^\alpha}{\alpha!}(\partial^\alpha f)(\mathbf a) \]" src="form_20.png"/>
</p>
<p> where: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial^\alpha f = \frac{\partial^{|\alpha|} f}{\partial^{\alpha_1} x_1\partial^{\alpha_2} x_2\dots\partial^{\alpha_n} x_n} \]" src="form_21.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha ! = \prod_{i=j}^n \alpha_j \]" src="form_22.png"/>
</p>
<p> and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ |\alpha| = \sum_{j=0}^n \alpha_j \]" src="form_23.png"/>
</p>
<p> The summation <img class="formulaInl" alt="$ \sum_{|\alpha| = 0}^n$" src="form_24.png"/> must then be taken over all possible combinations of <img class="formulaInl" alt="$\alpha_j \in N$" src="form_25.png"/> such that <img class="formulaInl" alt="$\sum_{j=1}^n \alpha_j = |\alpha|$" src="form_26.png"/>. The expression above, i.e. the Taylor expansion truncated at order <img class="formulaInl" alt="$m$" src="form_5.png"/> of a generic function <img class="formulaInl" alt="$f$" src="form_18.png"/>, is a polynomial <img class="formulaInl" alt="$\in \mathcal P_{n,m}$" src="form_8.png"/> in the variables <img class="formulaInl" alt="$\mathbf{dx} = \mathbf x-\mathbf a$" src="form_27.png"/>. We now show that if <img class="formulaInl" alt="$T_f, T_g \in \mathcal P_{n,m}$" src="form_28.png"/> are Taylor expansions of two functions <img class="formulaInl" alt="$f, g$" src="form_29.png"/> then the Taylor expansion of <img class="formulaInl" alt="$f\pm g, fg, f/g$" src="form_30.png"/> can be found operating on the algebra <img class="formulaInl" alt="$\mathcal P$" src="form_31.png"/>, thus computing <img class="formulaInl" alt="$T_f\pm T_g, T_f\cdot T_g, T_f/T_g$" src="form_32.png"/>. We may thus compute high order derivatives of multivariate functions computing their Taylor expansions and then extracting the desired coefficient.</p>
<h2><a class="anchor" id="d"></a>
Multiplication</h2>
<p>We here prove that the product of two truncated Taylor expansions is the truncated Taylor expansion of the product. We perform the proof for <img class="formulaInl" alt="$n=1$" src="form_33.png"/> as the notation is there clearer. The multivariate case is formally identical, requiring a more complex notation. The truncated Taylor expansion of the product between two functions <img class="formulaInl" alt="$f$" src="form_18.png"/> and <img class="formulaInl" alt="$g$" src="form_34.png"/> is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_{(fg)} = \sum_{k=0}^m \frac{(x-a)^k}{k!}(fg)^{(k)} \]" src="form_35.png"/>
</p>
<p> where we indicate with the superscript <img class="formulaInl" alt="$(i)$" src="form_36.png"/> the <img class="formulaInl" alt="$i$" src="form_37.png"/>-th derivative with respect to the independent variable. We show how the same expression is derived by multiplying the Taylor expansions of <img class="formulaInl" alt="$f$" src="form_18.png"/> and <img class="formulaInl" alt="$g$" src="form_34.png"/>: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_f T_g = \sum_{k=0}^m \frac{(x-a)^k}{k!}(f)^{(k)}\sum_{k=0}^m \frac{(x-a)^k}{k!}(g)^{(k)} = \sum_{k=0}^m c_k (x-a)^k \]" src="form_38.png"/>
</p>
<p> The coefficients <img class="formulaInl" alt="$c_k$" src="form_39.png"/> in the last power series are determined as the Cauchy product of the two Taylor series (or discrete convolution) and are: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ c_k = \sum_{n=0}^k \frac{f^{(n)}}{n!} \frac{g^{(k-n)}}{(k-n)!} = \frac{1}{k!}\sum_{n=0}^k {{k}\choose{n}}(f)^{(n)}(g)^{(k-n)} \]" src="form_40.png"/>
</p>
<p> applying now the general Leibniz rule to the last expression we get: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ c_k = \frac{1}{k!} (fg)^{(k)} \]" src="form_41.png"/>
</p>
<p> which allows us to conclude: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_{(fg)} = T_f \cdot T_g. \]" src="form_42.png"/>
</p>
<h2><a class="anchor" id="e"></a>
Reciprocal</h2>
<p>We here prove that the reciprocal of a truncated Taylor expansion, as defined in the algebra <img class="formulaInl" alt="$\mathcal P_{n,m}$" src="form_43.png"/> is the Taylor expansion of the reciprocal. Consider the generic function <img class="formulaInl" alt="$f$" src="form_18.png"/> and its truncated Taylor expansion <img class="formulaInl" alt="$T_f$" src="form_9.png"/>. We denote with <img class="formulaInl" alt="$T_{(1/f)}$" src="form_44.png"/> the truncated Taylor expansion of the reciprocal and apply the multiplication rule to derive that, necessarily, <img class="formulaInl" alt="$T_f T_{(1/f)} = 1$" src="form_45.png"/>. We separate the constant part of <img class="formulaInl" alt="$T_f$" src="form_9.png"/> from the rest writing <img class="formulaInl" alt="$T_f = f_0 +\hat f$" src="form_46.png"/> and we compute the product between <img class="formulaInl" alt="$T_f$" src="form_9.png"/> and the definition of reciprocal:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left(f_0 + \hat f\right)\frac 1f_0 \left(1 +\sum_{j=1}^m (-1)^j (\hat f / f_0)^j\right)= \]" src="form_47.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ = \frac 1f_0 \left(f_0 + \hat f\right)\left(1 - \frac{\hat f}{f_0} + \frac{\hat f^2}{f_0^2} - ... \right) = 1 \]" src="form_48.png"/>
</p>
<p>which allows us to conclude: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_{(1/f)} = \frac 1f_0 \left(1 +\sum_{j=1}^m (-1)^j (\hat f / f_0)^j\right) \]" src="form_49.png"/>
</p>
<h1><a class="anchor" id="f"></a>
Elementary functions</h1>
<p>Consider the MacLaurin expansion of a generic function <img class="formulaInl" alt="$g(x) = \sum g_n x^n$" src="form_50.png"/>. Consider now a multivariate function <img class="formulaInl" alt="$\hat f(\mathbf x) = \sum_{|\alpha|=1} f_\alpha \mathbf x^\alpha$" src="form_51.png"/> whose MacLaurin Taylor expansion does not have a constant term. The composition between these two functions will then be, trivially, <img class="formulaInl" alt="$(g \circ \hat f) (x) = \sum g_n (\sum_{|\alpha|=1} f_\alpha \mathbf x^\alpha)^n$" src="form_52.png"/>. If we now truncate such an expansion to order <img class="formulaInl" alt="$m$" src="form_5.png"/>, we get <img class="formulaInl" alt="$T_{g\circ f}= \sum_{n=0}^m g_n (\sum_{|\alpha|=1}^m f_\alpha \mathbf x^\alpha)^n $" src="form_53.png"/>, which can be written as:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_{g\circ \hat f} = T_g\circ T_{\hat f} \]" src="form_54.png"/>
</p>
<p>The above equation is called the <b>composition rule</b> and is only valid for functions whose Taylor expansion does not have a constant term and, is thus nil-potent of order <img class="formulaInl" alt="$m+1$" src="form_7.png"/> in <img class="formulaInl" alt="$\mathcal P_{n,m}$" src="form_43.png"/>. In general, we cannot compute the truncated Taylor expansion of a composition function directly composing the truncated Taylor expansions. For most elementary functions, though, we can consider <img class="formulaInl" alt="$T_f = f_0 + \hat f$" src="form_10.png"/> and use some addition formula to be able to ''extract`` <img class="formulaInl" alt="$\hat f$" src="form_14.png"/> and thus exploit its nil-potency. The details on how this is done differ for each particular <img class="formulaInl" alt="$g$" src="form_34.png"/> considered and are thus reported in the following subsections.</p>
<h2><a class="anchor" id="g"></a>
Exponential</h2>
<p>Let us consider the case of the exponential: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ g(x) = \exp(x) = \sum_{i=0} \frac{x^i}{i!} = 1 + x + \frac {x^2}{2} + ... \]" src="form_55.png"/>
</p>
<p> We want to compute the truncated Taylor expansion of <img class="formulaInl" alt="$\exp(f(\mathbf x))$" src="form_56.png"/> starting from the truncated Taylor expansion <img class="formulaInl" alt="$T_f = f_0 + \hat f$" src="form_10.png"/>. We thus write: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (g \circ f) (\mathbf x) = \exp(f(\mathbf x)) = \exp f_0 \exp (f(\mathbf x) - f_0) \]" src="form_57.png"/>
</p>
<p> note that, now, we can apply the <b>composition rule</b> to <img class="formulaInl" alt="$\exp (f(\mathbf x) - f_0)$" src="form_58.png"/> since the MacLaurin Taylor expansion of <img class="formulaInl" alt="$f(\mathbf x) - f_0$" src="form_59.png"/> does not have a constant term. Hence: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_{g \circ f} = \exp f_0 T_g \circ T_{\hat f} \]" src="form_60.png"/>
</p>
<p> and, finally: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_{(\exp f)} = \exp f_0 \sum_{i=0}^m \frac{\hat f^i}{i!} = \exp f_0 \left( 1 + \hat f + \frac {\hat f^2}{2!} + ... \right) \]" src="form_61.png"/>
</p>
<h2><a class="anchor" id="h"></a>
Logarithm</h2>
<p>Let us consider the case of the natural logarithm: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ g(x) = \log(x) \]" src="form_62.png"/>
</p>
<p> We want to compute the truncated Taylor expansion of <img class="formulaInl" alt="$\log(f(\mathbf x))$" src="form_63.png"/> starting from the truncated Taylor expansion <img class="formulaInl" alt="$T_f = f_0 + \hat f$" src="form_10.png"/>. We thus write: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (g \circ f) (\mathbf x) = \log(f(\mathbf x)) = \log (f_0 + (f(\mathbf x) - f_0)) = \log f_0 + \log(1 + \frac{f(\mathbf x) - f_0}{f_0}) \]" src="form_64.png"/>
</p>
<p> We can now apply the <b>composition rule</b> to get: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_{g \circ f} = \log f_0 + T_{\log(1+x)} \circ \frac{\hat f}{f_0} \]" src="form_65.png"/>
</p>
<p> and, using the known expression for MacLaurin expansion of <img class="formulaInl" alt="$\log(1+x)$" src="form_66.png"/>, we get: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_{(\log f)} = \log f_0 + \sum_{i=1}^m (-1)^{i+1} \frac 1i \left(\frac{\hat f}{f_0}\right)^i = \log f_0 + \frac{\hat f}{f_0} - \frac 12 \left(\frac{\hat f}{f_0}\right)^2 + ... \]" src="form_67.png"/>
</p>
<p> Note that the above expression is only defined if <img class="formulaInl" alt="$f_0 \ge 0$" src="form_68.png"/>.</p>
<h2><a class="anchor" id="j"></a>
Sine and cosine</h2>
<p>Let us consider the case of the sine and cosine functions: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_1(x) = \sin(x) = \sum_{i=0} (-1)^{i} \frac{x^{2i+1}}{(2i+1)!} = x - \frac{x^3}{3!} + \frac{x^5}{5!} - ... \]" src="form_69.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_2(x) = \cos(x) = \sum_{i=0} (-1)^{i} \frac{x^{2i}}{(2i)!} = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - ... \]" src="form_70.png"/>
</p>
<p> We want to compute the truncated Taylor expansion of <img class="formulaInl" alt="$\sin(f(\mathbf x))$" src="form_71.png"/>, <img class="formulaInl" alt="$\cos(f(\mathbf x))$" src="form_72.png"/> starting from the truncated Taylor expansion <img class="formulaInl" alt="$T_f = f_0 + \hat f$" src="form_10.png"/>. We thus write: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (g_1 \circ f) (\mathbf x) = \sin(f(\mathbf x)) = \sin f_0 \cos(f(\mathbf x) - f_0) + \cos f_0 \sin(f(\mathbf x) - f_0) \]" src="form_73.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ (g_2 \circ f) (\mathbf x) = \cos(f(\mathbf x)) = \cos f_0 \cos(f(\mathbf x) - f_0) - \sin f_0 \sin(f(\mathbf x) - f_0) \]" src="form_74.png"/>
</p>
<p> and, applying the <b>composition rule</b> to <img class="formulaInl" alt="$\cos(f(\mathbf x) - f_0)$" src="form_75.png"/> and <img class="formulaInl" alt="$\sin(f(\mathbf x) - f_0)$" src="form_76.png"/>, we get: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{array}{l} T_{(\sin f)} = \sin f_0 \left(\sum_{i=0}^{2i\le m} (-1)^{i} \frac{\hat f^{2i}}{(2i)!}\right) + \cos f_0 \left(\sum_{i=0}^{(2i+1)\le m} (-1)^{i} \frac{\hat f^{2i+1}}{(2i+1)!}\right) \\ T_{(\cos f)} = \cos f_0 \left(\sum_{i=0}^{2i\le m} (-1)^{i} \frac{\hat f^{2i}}{(2i)!}\right) - \sin f_0 \left(\sum_{i=0}^{(2i+1)\le m} (-1)^{i} \frac{\hat f^{2i+1}}{(2i+1)!}\right) \end{array} \]" src="form_77.png"/>
</p>
<h2><a class="anchor" id="k"></a>
Exponentiation</h2>
<p>Let us consider the case of the power function. </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ g(x) = x^\alpha \]" src="form_78.png"/>
</p>
<p> We want to compute the truncated Taylor expansion of <img class="formulaInl" alt="$f(\mathbf x)^\alpha$" src="form_79.png"/> assuming to have access to the truncated Taylor expansion of <img class="formulaInl" alt="$f$" src="form_18.png"/>, <img class="formulaInl" alt="$T_f = f_0 + \hat f$" src="form_10.png"/>. We thus write: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (g \circ f) (\mathbf x) = f(\mathbf x) ^ \alpha = (f_0 + (f(\mathbf x) - f_0))^\alpha = f_0^\alpha \left( 1+ \frac{f(x) - f_0}{f_0}\right)^\alpha \]" src="form_80.png"/>
</p>
<p> We can now apply the <b>composition rule</b> to get: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_{f(\mathbf x)^\alpha} = f_0^\alpha \left(T_{(1+x)^\alpha}\circ \frac{\hat f}{f_0}\right) = \]" src="form_81.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ = f_0^\alpha \sum_{k=0}^m {\alpha \choose k} \left(\frac{\hat f}{f_0}\right)^k = f_0^\alpha\left(1 + \alpha \frac{\hat f}{f_0} + \frac{\alpha (\alpha - 1)}{2}\left(\frac{\hat f}{f_0}\right)^2 + ... \right) \]" src="form_82.png"/>
</p>
<h1><a class="anchor" id="l"></a>
Simple Examples (can be done by hand)</h1>
<p>In the above sections we derived a number of results that allow operating on simple Taylor expansions to compute Taylor expansions of increasingly complex expressions. We summarize here those results (keep in mind that <img class="formulaInl" alt="$T_f = f_0 + \hat f$" src="form_10.png"/>) :</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{array}{l} T_{f\pm g} = T_f \pm T_g\\ T_{fg} = T_f \cdot T_g\\ T_{(1/f)} = \frac 1f_0 \left(1 +\sum_{k=1}^m (-1)^k (\hat f / f_0)^k\right)\\ T_{(\exp f)} = \exp f_0 \sum_{k=0}^m \frac{\hat f^k}{k!} \\ T_{(\log f)} = \log f_0 - \sum_{k=1}^m \frac{(-1)^k}k \left(\hat f / f_0\right)^k \\ T_{(\sin f)} = \sin f_0 \left(\sum_{k=0}^{2k\le m} (-1)^{k} \frac{\hat f^{2k}}{(2k)!}\right) + \cos f_0 \left(\sum_{k=0}^{(2k+1)\le m} (-1)^k \frac{\hat f^{2k+1}}{(2k+1)!}\right) \\ T_{(\cos f)} = \cos f_0 \left(\sum_{k=0}^{2k\le m} (-1)^{k} \frac{\hat f^{2k}}{(2k)!}\right) - \sin f_0 \left(\sum_{k=0}^{(2k+1)\le m} (-1)^k \frac{\hat f^{2k+1}}{(2k+1)!}\right) \\ T_{(f^\alpha)} = f_0^\alpha \sum_{k=0}^m {\alpha \choose k} \left(\hat f / f_0\right)^k \end{array} \]" src="form_83.png"/>
</p>
<p> It is worth mentioning here that other functions such as the inverse functions, the hyperbolic functions etc. can also be treated in this way. The above equations can be used to find Taylor expansions of increasingly complex functions by simply operating on the algebra <img class="formulaInl" alt="$\mathcal P_{n,m}$" src="form_43.png"/>. Once a Taylor expansion is computed, its coefficients can be extracted to obtain the value of any desired derivative. We have thus built an automated differentiation system. While the formalism presented can, at first, appear complex, the system is rather simple as we hope will appear from the following examples.</p>
<h2><a class="anchor" id="cv"></a>
Example 1 - A multiplication</h2>
<p>Consider the simple function of two variables: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(x,y) = x + 3xy + y^2 \]" src="form_84.png"/>
</p>
<p> Its Taylor expansion <img class="formulaInl" alt="$T_f \in \mathcal P_{2,2}$" src="form_85.png"/> can be computed as: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_f = T_x + 3T_x \cdot T_y + T_y\cdot T_y \]" src="form_86.png"/>
</p>
<p> Let us explicitly compute such an expression at the point <img class="formulaInl" alt="$x=3$" src="form_87.png"/>, <img class="formulaInl" alt="$y=7$" src="form_88.png"/>. The exact sequence of computations to be performed is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_x = 3 + 1 dx + 0 dy + 0 dxdy + 0 dx^2 + 0 dy^2 \]" src="form_89.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_y = 7 + 0 dx + 1 dy + 0 dxdy + 0 dx^2 + 0 dy^2 \]" src="form_90.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_x \cdot T_y = 21 + 7 d x + 3 d y + 1 dxdy + 0 dx^2 + 0 dy^2 \]" src="form_91.png"/>
</p>
<p> and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_y \cdot T_y = 49 + 0 dx + 14 dy + 0 dxdy + 0 dx^2 + 1 dy^2 \]" src="form_92.png"/>
</p>
<p> We can then derive the final expression: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_f = 115 + 22 dx + 23 dy +3 dxdy + 0 dx^2 + 1 dy^2 \]" src="form_93.png"/>
</p>
<p> and we may easily extract the derivatives comparing this expression to the generic form of a Taylor expansion: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f = 115, \partial_x f = 22, \partial_y f = 23, \partial_{xy} f = 3, \partial_{xx} f = 0, \partial_{yy} f = 2, \]" src="form_94.png"/>
</p>
<h2><a class="anchor" id="x"></a>
Example 2 - A division</h2>
<p>Consider the simple function of two variables: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f = 1 / (x + 2xy + y^2) = 1 / p \]" src="form_95.png"/>
</p>
<p> Its Taylor expansion <img class="formulaInl" alt="$T_f \in \mathcal P_{2,2}$" src="form_85.png"/> in (say) <img class="formulaInl" alt="$x=0$" src="form_96.png"/>, <img class="formulaInl" alt="$y=1$" src="form_97.png"/> can be computed as follows: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_x = 0 + 1 dx + 0 dy + 0 dxdy + 0 dx^2 + 0 dy^2 \]" src="form_98.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_y = 1 + 0 dx + 1 dy + 0 dxdy + 0 dx^2 + 0 dy^2 \]" src="form_99.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_p = 1 + 3 dx + 2 dy +2 dxdy + 0 dx^2 + 1 dy^2 \]" src="form_100.png"/>
</p>
<p> and, applying the reciprocal rule, we conclude </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_f = ( 1 - \hat p + \hat p ^ 2 ) \]" src="form_101.png"/>
</p>
<p> where <img class="formulaInl" alt="$\hat p = 3 dx + 2 dy +2 dxdy + 0 dx^2 + 1 dy^2$" src="form_102.png"/>, hence: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_f = 1 -3 dx -2 dy + 10dxdy + 9dx^2 + 3dy^2 \]" src="form_103.png"/>
</p>
<p> which allows, as in the previous example, to compute all derivatives up to order two: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f = 1, \partial_x f = -3, \partial_y f = -2, \partial_{xy} f = 10, \partial_{xx} f = 18, \partial_{yy} f = 6, \]" src="form_104.png"/>
</p>
 <h2><a class="anchor" id="cd"></a>
Example 3 - An exponential</h2>
<p>Consider the elementary function of two variables: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f = \exp(xy) \]" src="form_105.png"/>
</p>
<p> Its Taylor expansion <img class="formulaInl" alt="$T_f \in \mathcal P_{2,2}$" src="form_85.png"/> in (say) <img class="formulaInl" alt="$x=1$" src="form_106.png"/>, <img class="formulaInl" alt="$y=0$" src="form_107.png"/> can be computed as follows: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_x = 1 + 1 dx + 0 dy + 0 dxdy + 0 dx^2 + 0 dy^2 \]" src="form_108.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_y = 0 + 0 d x + 1 dy + 0 dxdy + 0 dx^2 + 0 dy^2 \]" src="form_109.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_x \cdot T_y = 0 + 0 dx + 1 dy + 1 dxdy + 0 dx^2 + 0dy^2 \]" src="form_110.png"/>
</p>
<p> and, applying the rule for the exponential of Taylor series, we conclude: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_f = 1 + dy + dxdy + \frac 12 dy^2 \]" src="form_111.png"/>
</p>
<p> and, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f = 1, \partial_x f = 0, \partial_y f = 1, \partial_{xy} f = 1, \partial_{xx} f = 0, \partial_{yy} f = 1, \]" src="form_112.png"/>
</p>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
